<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<script type="text/javascript">
		let data = {
			price: 5,
			quantity: 10
		}
		let target = null
		let total
		function Dep(){
			this.subscribers = []
			let depend = function(){
				if(target && !this.subscribers.includes(target)){
					this.subscribers.push(target)
				}
			}
			let notify = function(){
				this.subscribers.forEach(ran=>ran())
			}
			this.depend = depend
			this.notify = notify
		}
		let dep = new Dep()
		watcher(function(){total = data.price * data.quantity})
		function watcher(fn){
			target = fn
			dep.depend()
			target = null
		}
		data.quantity = 5
		dep.notify()
		console.log(total)
	</script>
</body>
</html>